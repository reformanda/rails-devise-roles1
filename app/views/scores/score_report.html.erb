<div class="row  white-bg page-heading">
    <div class="col-lg-8 col-lg-offset-1">
        <h2>USAASC Virtual Boards <%= ENV["APP_VERSION"] %></h2>
        <ol class="breadcrumb">
            <li>
                <a href="<%= url_for :controller => 'landing', :action => 'index' %>">Home</a>
            </li>
            <li>
                <a href="<%= url_for :controller => 'scores', :action => 'reports' %>">Score Reports</a>
            </li>
            <li class="active">
            <strong><%= @board.description %></strong>
            </li>
        </ol>
    </div>
    <div class="col-lg-2">
    <div class="title-action">
        <%= link_to '/users/sign_out', :method => :delete do %><i class="fa fa-sign-out"></i> Signoff<% end %>
    </div>
    </div>
</div>

<div class="row page-heading">
</div>

<div class="row">
    <div class="col-lg-10 col-lg-offset-1">
      <p id="notice"><%= notice %></p>
    </div>
</div>

<div class="row">
  <div class="col-lg-10 col-lg-offset-1">
    <div class="ibox float-e-margins">
      <div class="ibox-title">
          <h5>Score Report - <%= @board.description %></h5>
          <div class="title-action">

          </div>
      </div>
      <div class="ibox-content">




          <% @award_options.find_each do |aw|  %>

          <table class="table table-striped table-bordered table-hover dataTables-example">
            <caption>

                <h4> <%= aw.name %></h4>

            </caption>
            <thead>
              <tr>
                <th scope="col">Judge</th>
                <th scope="col">Individual Name and Organization</th>
                <th scope="col">Submission Packet</th>
                <th scope="col">1. Specific Achievements<br/>(1-50 points)</th>
                <th scope="col">2. Value of the Nominee's Contributions <br/>(1-30 points)</th>
                <th scope="col">3. Demonstration of Leadership<br/>(1-20 points)</th>
                <th scope="col">Total By Judge</th>
                <th scope="col">Grand Total</th>

              </tr>
            </thead>
            <tbody>


            <% @noms = @nominations.where("award_option_id = ?", aw.id) %>
            <% @noms.find_each do |nom| %>

            <% @board.users_list.each do |judge| %>
            <% if not judge.blank? %>
            <% grand_total = @scores.where("nomination_id = ? and user_id in (?)", nom.id, @board.users_list).sum(:score_total) %>

            <% score = @scores.where("nomination_id = ? and user_id = ?", nom.id, judge).first || Score.new %>

          <tr>
            <td> <%= User.find(judge).name %> </td>


            <td >

              <div class="form-group">
                <% if nom.nominee_team_name.blank? %>
                  <%= "#{nom.nominee_title} #{nom.nominee_first_name} #{nom.nominee_last_name} #{nom.nominee_suffix}" %>
                <% else %>
                  <%= nom.nominee_team_name %>
                <% end %>
                <br/>
                <%= nom.nominee_organization %>
                <br/>
              </div>

            </td>

            <td>
              <% if not nom.submission_packet_url.blank? %>
              <%= link_to "View", nom.submission_packet_url, :target => "_blank" %>
              <% else %>
              Not Available
              <% end %>
            </td>

            <td >
                <div class="form-group">
                  <%=  score.score_1 %>
                </div>
            </td>

            <td >
                <div class="form-group">
                  <%= score.score_2 %>
                </div>
            </td>

            <td >
                <div class="form-group">
                  <%=  score.score_3 %>
                </div>
            </td>

            <td>
              <div class="form-group">
                <%=  score.score_total %>
              </div>
            </td>

            <td>
              <div class="form-group">
                <%=  grand_total %>
              </div>
            </td>

          </tr>
              <% end %>
            <% end %>

            <% end %>


            </tbody>

          </table>

          <div class="hr-line-dashed"></div>

          <% end %>



      </div>
    </div>
  </div>
</div>

<% content_for :javascript do %>

<script type="text/javascript">


$(function() {

    $('.dataTables-example').DataTable({
        dom: '<"html5buttons"B>',
        buttons: [
            //{ extend: 'copy'},
            {extend: 'csv'},
            {extend: 'excel', title: 'ExampleFile'},
            //{extend: 'pdf', title: 'ExampleFile'},

            {extend: 'print',
                customize: function (win){
                    $(win.document.body).addClass('white-bg');
                    $(win.document.body).css('font-size', '10px');

                    $(win.document.body).find('table')
                            .addClass('compact')
                            .css('font-size', 'inherit');
                }
            }
        ]

    });

});

</script>

<% end %>
